<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NyayaNet - Map</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<style>
main { max-width:900px; margin:2rem auto; text-align:center; }
#map { height:500px; width:100%; border-radius:10px; box-shadow:0 4px 15px rgba(0,0,0,0.1); }
h2 { margin-bottom:1rem; }
</style>
</head>
<body>
<header>
<h1>NyayaNet</h1>
<nav>
<a href="index.html">Home</a>
<a href="view.html">View Issues</a>
<a href="map.html" class="active">Map</a>
<a href="resources.html">Resources</a>
</nav>
</header>

<main>
<h2>Map of Submitted Issues</h2>
<div id="map"></div>
</main>

<script>
const issues = JSON.parse(localStorage.getItem("issues")) || [];

function initMap(){
    if(issues.length === 0){
        document.getElementById("map").innerHTML = "<p>No issues submitted yet.</p>";
        return;
    }

    // Center map on last submission
    const last = issues[issues.length-1];
    const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 5,
        center: { lat: parseFloat(last.lat), lng: parseFloat(last.lon) }
    });

    issues.forEach((issue,index)=>{
        new google.maps.Marker({
            position: { lat: parseFloat(issue.lat), lng: parseFloat(issue.lon) },
            map: map,
            title: `${issue.issue} (${issue.name})`,
            icon: index===issues.length-1 ? "http://maps.google.com/mapfiles/ms/icons/red-dot.png" : "http://maps.google.com/mapfiles/ms/icons/green-dot.png"
        });
    });
}
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBe09MpSM_BlXf1q32M7xB06OvHKHiKuxo"></script>
</body>
</html>
